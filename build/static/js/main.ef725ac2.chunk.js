(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{20:function(e,t,a){},26:function(e,t,a){e.exports=a(45)},31:function(e,t,a){},32:function(e,t,a){},33:function(e,t,a){},34:function(e,t,a){},44:function(e,t,a){},45:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),o=a(21),i=a.n(o),r=(a(31),a(2));a(32);var s=function(){var e=Object(n.useState)("profile:read_all,activity:read"),t=Object(r.a)(e,2),a=t[0];return t[1],c.a.createElement("div",{className:"home"},c.a.createElement("h1",{className:"home_title"},"GRETRAINING"),c.a.createElement("button",{className:"home_login",onClick:function(){window.open("https://www.strava.com/oauth/authorize?client_id=74263&redirect_uri=https://apistrava-1c4c0.web.app/exchange_token&response_type=code&approval_prompt=force&scope=".concat(a),"_self")},type:"submit"},"log in"))},l=(a(33),a(34),Object(n.createContext)()),m=function(e){var t=e.reducer,a=e.initialState,o=e.children;return c.a.createElement(l.Provider,{value:Object(n.useReducer)(t,a)},o)},d=function(){return Object(n.useContext)(l)},_=a(3);var u=function(e){var t=e.active,a=d(),n=Object(r.a)(a,2),o=(n[0].accesToken,n[1],Object(_.f)());return c.a.createElement("div",{className:"navbar_com"},c.a.createElement("div",{className:"navbar"},c.a.createElement("div",{onClick:function(){return o.push("/")},className:"navbar_element ".concat("home"===t&&"navbar_element_active")},"Home"),c.a.createElement("div",{onClick:function(){return o.push("/myactivities")},className:"navbar_element ".concat("act"===t&&"navbar_element_active")},"my activities"),c.a.createElement("div",{onClick:function(){return o.push("/mysufferscores")},className:"navbar_element ".concat("suf"===t&&"navbar_element_active")},"weekly intensity chart")))};var f=function(e){var t=e.Notredirect,a=d(),o=Object(r.a)(a,2),i=o[0],s=i.accesToken,l=i.expires_at,m=i.refresh_token,u=o[1],f=Object(n.useState)([]),p=Object(r.a)(f,2),v=(p[0],p[1]),h=(Object(_.f)(),Object(n.useState)(!0)),b=Object(r.a)(h,2),E=(b[0],b[1]);return Object(n.useEffect)((function(){if(null===s&&t){var e=window.location.search.split("&"),a=e[1].split("=")[1],n=e[2];v(n.split("=")[1].split(",")),console.log("code:",a);var c={client_id:"74263",client_secret:"de95dd8ef27c44d1c6f385779f381ec75e92fb8b",code:a,grant_type:"authorization_code"};fetch("https://www.strava.com/oauth/token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)}).then((function(e){return e.json()})).then((function(e){e.access_token&&(u({type:"SET_ACCESTOKEN",accesToken:e.access_token,expires_at:e.expires_at,refresh_token:e.refresh_token}),E(!1))}))}else if(Date.now()/1e3>=l&&null!=l){console.log(Date.now()/1e3,l);var o={client_id:"74263",client_secret:"de95dd8ef27c44d1c6f385779f381ec75e92fb8b",code:m,grant_type:"refresh_token"};fetch("https://www.strava.com/oauth/token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)}).then((function(e){return e.json()})).then((function(e){e.access_token&&u({type:"SET_ACCESTOKEN",accesToken:e.access_token,expires_at:e.expires_at,refresh_token:e.refresh_token})}))}}),[]),c.a.createElement("div",null)},p=a(8),v=(a(20),a(6)),h=a.n(v),b=a(15),E=a.n(b);var y=function(){var e=d(),t=Object(r.a)(e,2),a=t[0].accesToken,o=(t[1],Object(_.g)().id),i=Object(n.useState)(),s=Object(r.a)(i,2),l=s[0],m=s[1],u=Object(n.useState)(!1),f=Object(r.a)(u,2),p=f[0],v=f[1];return Object(n.useEffect)((function(){console.log(o),fetch("https://www.strava.com/api/v3/activities/".concat(o,"?include_all_efforts=true"),{method:"GET",headers:{authorization:"Bearer "+a,accept:"application/json"}}).then((function(e){return e.json()})).then((function(e){v(e)}));var e={data:a};fetch("/getauthathlete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(e){m(e.data)})).catch((function(e){console.error("Error:",e)}))}),[]),Object(n.useEffect)((function(){if(p&&("Ride"===p.type||"Run"===p.type||"Walk"===p.type)){var e=[[51.47832,3.526]],t=h.a.map("mape").setView(e[0],13);h.a.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery \xa9 <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:18,id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1,accessToken:"pk.eyJ1IjoicGlldGcxMjM0IiwiYSI6ImNrd2RocDFidzQ0eHUzMHJveGNmY2UyYnAifQ.r2rclJ70-a9SMFZRZQ8H8w"}).addTo(t);for(var a=E.a.decode(p.map.summary_polyline),n=0;n<a.length;n++)e[n]={lat:a[n][0],lng:a[n][1]};h.a.polyline(e,{color:"red",weight:5,opacity:.7,lineJoin:"round"}).addTo(t)}}),[p]),c.a.createElement("div",{className:"act"},c.a.createElement("div",{className:"act_header"},c.a.createElement("img",{className:"act_header_img",src:null===l||void 0===l?void 0:l.profile_medium}),c.a.createElement("p",{className:"act_header_name"},null===l||void 0===l?void 0:l.firstname)),c.a.createElement("div",{className:"act_body"},c.a.createElement("h1",null,p.name),c.a.createElement("div",{className:"act_body_map"},c.a.createElement("div",{id:"mape",className:"map"}))),c.a.createElement("div",{className:"act_footer"},"kudos: ",p.kudos_count),c.a.createElement("div",{className:"act_body_info"},c.a.createElement("div",{className:"act_body_info_container"},c.a.createElement("div",{className:"act_body_info_container_option_light"},"Distance"),c.a.createElement("div",{className:"act_body_info_container_option"}," ",Math.round(p.distance)/1e3,"km")),c.a.createElement("div",{className:"act_body_info_container"},c.a.createElement("div",{className:"act_body_info_container_option_light"},"Average speed"),c.a.createElement("div",{className:"act_body_info_container_option"}," ",Math.round(60*p.average_speed*60/1e3),"km/h")),c.a.createElement("div",{className:"act_body_info_container"},c.a.createElement("div",{className:"act_body_info_container_option_light"},"average heartrate"),c.a.createElement("div",{className:"act_body_info_container_option"}," ",p.average_heartrate,"bpm")),c.a.createElement("div",{className:"act_body_info_container"},c.a.createElement("div",{className:"act_body_info_container_option_light"},"average speed"),c.a.createElement("div",{className:"act_body_info_container_option"}," ",Math.round(60*p.average_speed*60/1e3),"km/h")),c.a.createElement("div",{className:"act_body_info_container"},c.a.createElement("div",{className:"act_body_info_container_option_light"},"moving time"),c.a.createElement("div",{className:"act_body_info_container_option"}," ",p.moving_time/60,"minutes")),c.a.createElement("div",{className:"act_body_info_container"},c.a.createElement("div",{className:"act_body_info_container_option_light"},"moving time"),c.a.createElement("div",{className:"act_body_info_container_option"}," ",p.moving_time/60,"minutes"))),c.a.createElement("div",{className:"act_body_info"},"Ride"===p.type&&c.a.createElement("div",{className:"act_body_info_container"},c.a.createElement("div",{className:"act_body_info_container_option_light"},"average watts"),c.a.createElement("div",{className:"act_body_info_container_option"}," ",p.average_watts,"w")),"Ride"===p.type&&c.a.createElement("div",{className:"act_body_info_container"},c.a.createElement("div",{className:"act_body_info_container_option_light"},"weighted average watts"),c.a.createElement("div",{className:"act_body_info_container_option"}," ",p.weighted_average_watts,"w"))),c.a.createElement("div",{className:"act_body_info"},c.a.createElement("div",{className:"act_body_info_container"},c.a.createElement("div",{className:"act_body_info_container_option_light"},"suffer score"),c.a.createElement("div",{className:"act_body_info_container_option"}," ",p.suffer_score))))};a(43);var g=function(e){var t=e.counter,a=e.data,o=e.accesToken,i=Object(n.useState)(a.athlete.id),s=Object(r.a)(i,2),l=(s[0],s[1],Object(n.useState)()),m=Object(r.a)(l,2),d=m[0],u=m[1],f=Object(_.f)();return Object(n.useEffect)((function(){console.log(t);if(fetch("https://www.strava.com/api/v3/athlete",{method:"GET",headers:{authorization:"Bearer "+o,accept:"application/json"}}).then((function(e){return e.json()})).then((function(e){u(e)})),"Ride"===a.type||"Run"===a.type){var e=[[51.47832,3.526]],n=h.a.map("map".concat(t)).setView(e[0],13);h.a.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery \xa9 <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:18,id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1,accessToken:"pk.eyJ1IjoicGlldGcxMjM0IiwiYSI6ImNrd2RocDFidzQ0eHUzMHJveGNmY2UyYnAifQ.r2rclJ70-a9SMFZRZQ8H8w"}).addTo(n);for(var c=E.a.decode(a.map.summary_polyline),i=0;i<c.length;i++)e[i]={lat:c[i][0],lng:c[i][1]};h.a.polyline(e,{color:"red",weight:5,opacity:.7,lineJoin:"round"}).addTo(n)}}),[]),c.a.createElement("div",{onClick:function(){return f.push("/activity/".concat(a.id))},className:"act"},c.a.createElement("div",{className:"act_header"},c.a.createElement("img",{className:"act_header_img",src:null===d||void 0===d?void 0:d.profile_medium}),c.a.createElement("p",{className:"act_header_name"},null===d||void 0===d?void 0:d.firstname)),c.a.createElement("div",{className:"act_body"},c.a.createElement("h1",null,a.name),c.a.createElement("div",{className:"act_body_info"},c.a.createElement("div",{className:"act_body_info_container"},c.a.createElement("div",{className:"act_body_info_container_option_light"},"Distance"),c.a.createElement("div",{className:"act_body_info_container_option"}," ",Math.round(a.distance/1e3),"km")),c.a.createElement("div",{className:"act_body_info_container"},c.a.createElement("div",{className:"act_body_info_container_option_light"},"average speed"),c.a.createElement("div",{className:"act_body_info_container_option"}," ",Math.round(60*a.average_speed*60/1e3),"km/h"))),c.a.createElement("div",{onClick:function(e){return e.stopPropagation()},className:"act_body_map"},c.a.createElement("div",{id:"map".concat(t),className:"map"}))),c.a.createElement("div",{className:"act_footer"},"kudos: ",a.kudos_count))};var N=function(){var e=Object(n.useState)([]),t=Object(r.a)(e,2),a=t[0],o=t[1],i=d(),s=Object(r.a)(i,2),l=s[0].accesToken;return s[1],Object(n.useEffect)((function(){console.log(l);console.log("Bearer "+l),fetch("https://www.strava.com/api/v3/athlete/activities?page=1&per_page=30",{method:"GET",headers:{authorization:"Bearer "+l,accept:"application/json"}}).then((function(e){return e.json()})).then((function(e){o(e)}))}),[]),c.a.createElement("div",null,a&&c.a.createElement("div",{className:"activities"},a.map((function(e,t){return c.a.createElement(g,{counter:t,data:e,key:t,accesToken:l})}))))},w=a(25),j=a(23);a(44);var k=function(){var e=d(),t=Object(r.a)(e,1)[0].accesToken,a=Object(n.useState)([]),o=Object(r.a)(a,2),i=o[0],s=o[1],l=Object(n.useState)(),m=Object(r.a)(l,2),_=m[0],u=m[1],f=Object(n.useState)(!1),p=Object(r.a)(f,2),v=p[0],h=p[1];return Object(n.useEffect)((function(){console.log(t);fetch("https://www.strava.com/api/v3/athlete/activities?page=1&per_page=30",{method:"GET",headers:{authorization:"Bearer "+t,accept:"application/json"}}).then((function(e){return e.json()})).then((function(e){console.log("Success, Data:",e),console.log(e);var t=new Date,a=t.getDay();t=0===a?Date.now()/1e3-604800:(t=new Date(t.setDate(t.getDate()+(7-a)-6))).getTime()/1e3;for(var n=0,c=0,o=0;o<e.length;o++){var i=new Date(e[o].start_date_local).getTime()/1e3;i>=t&&(n+=e[o].suffer_score),(i<t||o===e.length-1)&&(s((function(e){var t=e,a=[c,n];return[].concat(Object(w.a)(t),[a])})),c+=1,t-=604800,n=e[o].suffer_score)}u(c)}))}),[]),Object(n.useEffect)((function(){if(i.length===_){console.log(i);for(var e=[["time","suffer score"]],t=1,a=i.length-1;a>=0;a--)e[t]=[t-1,i[a][1]],t+=1;console.log(e),s(e),h(!0)}}),[_,i]),c.a.createElement("div",{className:"suffer"},v&&c.a.createElement(j.a,{width:"600px",height:"500px",chartType:"LineChart",loader:c.a.createElement("div",null,"Loading Chart"),data:i,options:{title:"Suffer scores",hAxis:{title:"time",titleTextStyle:{color:"#333"}},vAxis:{minValue:0,maxValue:200}}}))};var O=function(){return c.a.createElement(p.a,null,c.a.createElement("div",{className:"app"},c.a.createElement(_.c,null,c.a.createElement(_.a,{path:"/exchange_token"},c.a.createElement(u,{active:"home"}),c.a.createElement(f,{Notredirect:!0})),c.a.createElement(_.a,{path:"/activity/:id"},c.a.createElement(f,null),c.a.createElement(u,{active:"act"}),c.a.createElement(y,null)),c.a.createElement(_.a,{path:"/myactivities"},c.a.createElement(f,null),c.a.createElement(u,{active:"act"}),c.a.createElement(N,null)),c.a.createElement(_.a,{path:"/mysufferscores"},c.a.createElement(f,null),c.a.createElement(u,{active:"suf"}),c.a.createElement(k,null)),c.a.createElement(_.a,{path:"/"},c.a.createElement(s,null)))))},T=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,47)).then((function(t){var a=t.getCLS,n=t.getFID,c=t.getFCP,o=t.getLCP,i=t.getTTFB;a(e),n(e),c(e),o(e),i(e)}))},S=a(18),x=function(e,t){switch(t.type){case"SET_ACCESTOKEN":return Object(S.a)(Object(S.a)({},e),{},{accesToken:t.accesToken,expires_at:t.expires_at,refresh_token:t.refresh_token});default:return e}};i.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(m,{initialState:{accesToken:null,expires_at:null,refresh_token:null},reducer:x},c.a.createElement(O,null))),document.getElementById("root")),T()}},[[26,1,2]]]);
//# sourceMappingURL=main.ef725ac2.chunk.js.map